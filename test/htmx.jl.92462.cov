        - using Test
        - using HTMLForge
        - import HTMLForge: ensurehxprefix, load_trigger, revealed_trigger,
        -                   intersect_trigger, poll_trigger, VALID_SWAP_STYLES
        - 
        1 @testset "htmx" begin
        -     # ──────────────────────────────────────────────
        -     # ensurehxprefix
        -     # ──────────────────────────────────────────────
        1     @testset "ensurehxprefix" begin
        3         @test ensurehxprefix("get") == "data-hx-get"
        1         @test ensurehxprefix(:get) == "data-hx-get"
        1         @test ensurehxprefix("hx-get") == "data-hx-get"
        1         @test ensurehxprefix("data-hx-get") == "data-hx-get"
        1         @test ensurehxprefix("trigger") == "data-hx-trigger"
        1         @test ensurehxprefix(:trigger) == "data-hx-trigger"
        1         @test ensurehxprefix("hx-trigger") == "data-hx-trigger"
        -     end
        - 
        -     @testset "ensurehxprefix edge cases" begin
        -         # Symbol with data-hx- prefix already
        2         @test ensurehxprefix(Symbol("data-hx-target")) == "data-hx-target"
        -         # Symbol with hx- prefix
        1         @test ensurehxprefix(Symbol("hx-swap")) == "data-hx-swap"
        -         # Long compound attribute names
        1         @test ensurehxprefix("swap-oob") == "data-hx-swap-oob"
        1         @test ensurehxprefix("disabled-elt") == "data-hx-disabled-elt"
        1         @test ensurehxprefix("replace-url") == "data-hx-replace-url"
        1         @test ensurehxprefix("push-url") == "data-hx-push-url"
        1         @test ensurehxprefix("history-elt") == "data-hx-history-elt"
        1         @test ensurehxprefix("select-oob") == "data-hx-select-oob"
        -         # Single character attribute
        1         @test ensurehxprefix("x") == "data-hx-x"
        1         @test ensurehxprefix(:x) == "data-hx-x"
        -         # Various htmx attribs via Symbol
        1         @test ensurehxprefix(:boost) == "data-hx-boost"
        1         @test ensurehxprefix(:confirm) == "data-hx-confirm"
        1         @test ensurehxprefix(:indicator) == "data-hx-indicator"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxattr!
        -     # ──────────────────────────────────────────────
        -     @testset "hxattr!" begin
        2         el = HTMLElement(:div)
        1         result = hxattr!(el, "custom", "value")
        1         @test result === el
        1         @test getattr(el, "data-hx-custom") == "value"
        -     end
        - 
        -     @testset "hxattr! edge cases" begin
        -         # Symbol attr argument
        2         el = HTMLElement(:div)
        1         hxattr!(el, :loading, "lazy")
        1         @test getattr(el, "data-hx-loading") == "lazy"
        - 
        -         # Attr already has hx- prefix → gets converted to data-hx-
        1         el2 = HTMLElement(:div)
        1         hxattr!(el2, "hx-custom", "val")
        1         @test getattr(el2, "data-hx-custom") == "val"
        - 
        -         # Attr already has data-hx- prefix → stays as is
        1         el3 = HTMLElement(:div)
        1         hxattr!(el3, "data-hx-custom", "val2")
        1         @test getattr(el3, "data-hx-custom") == "val2"
        - 
        -         # Empty value string
        1         el4 = HTMLElement(:div)
        1         hxattr!(el4, "ext", "")
        1         @test getattr(el4, "data-hx-ext") == ""
        - 
        -         # Overwriting an existing htmx attribute
        1         el5 = HTMLElement(:div)
        1         hxattr!(el5, "target", "#first")
        1         @test getattr(el5, "data-hx-target") == "#first"
        1         hxattr!(el5, "target", "#second")
        1         @test getattr(el5, "data-hx-target") == "#second"
        - 
        -         # Value with special characters
        1         el6 = HTMLElement(:div)
        1         hxattr!(el6, "vals", "{\"key\": \"value with spaces & symbols <>\"}}")
        1         @test getattr(el6, "data-hx-vals") ==
        -               "{\"key\": \"value with spaces & symbols <>\"}}"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxrequest!
        -     # ──────────────────────────────────────────────
        -     @testset "hxrequest!" begin
        2         el = HTMLElement(:div)
        1         result = hxrequest!(el, :get, "/api/data")
        1         @test result === el  # mutates in place
        1         @test getattr(el, "data-hx-get") == "/api/data"
        - 
        1         el2 = HTMLElement(:button)
        1         hxrequest!(el2, "post", "/api/submit")
        1         @test getattr(el2, "data-hx-post") == "/api/submit"
        - 
        1         el3 = HTMLElement(:form)
        1         hxrequest!(el3, :put, "/api/update")
        1         @test getattr(el3, "data-hx-put") == "/api/update"
        - 
        1         el4 = HTMLElement(:span)
        1         hxrequest!(el4, :patch, "/api/patch")
        1         @test getattr(el4, "data-hx-patch") == "/api/patch"
        - 
        1         el5 = HTMLElement(:a)
        1         hxrequest!(el5, :delete, "/api/remove")
        1         @test getattr(el5, "data-hx-delete") == "/api/remove"
        -     end
        - 
        -     @testset "hxrequest! edge cases" begin
        -         # Mixed case string method → lowercased
        2         el = HTMLElement(:div)
        1         hxrequest!(el, "GET", "/api/upper")
        1         @test getattr(el, "data-hx-get") == "/api/upper"
        - 
        1         el2 = HTMLElement(:div)
        1         hxrequest!(el2, "Post", "/api/mixed")
        1         @test getattr(el2, "data-hx-post") == "/api/mixed"
        - 
        1         el3 = HTMLElement(:div)
        1         hxrequest!(el3, "DELETE", "/api/upper-delete")
        1         @test getattr(el3, "data-hx-delete") == "/api/upper-delete"
        - 
        -         # URL with query params
        1         el4 = HTMLElement(:div)
        1         hxrequest!(el4, :get, "/api/search?q=test&page=1")
        1         @test getattr(el4, "data-hx-get") == "/api/search?q=test&page=1"
        - 
        -         # URL with fragment
        1         el5 = HTMLElement(:div)
        1         hxrequest!(el5, :get, "/page#section")
        1         @test getattr(el5, "data-hx-get") == "/page#section"
        - 
        -         # Empty URL
        1         el6 = HTMLElement(:div)
        1         hxrequest!(el6, :post, "")
        1         @test getattr(el6, "data-hx-post") == ""
        - 
        -         # Overwriting a request method
        1         el7 = HTMLElement(:div)
        1         hxrequest!(el7, :get, "/first")
        1         @test getattr(el7, "data-hx-get") == "/first"
        1         hxrequest!(el7, :get, "/second")
        1         @test getattr(el7, "data-hx-get") == "/second"
        - 
        -         # Multiple different methods on same element
        1         el8 = HTMLElement(:div)
        1         hxrequest!(el8, :get, "/get-url")
        1         hxrequest!(el8, :post, "/post-url")
        1         @test getattr(el8, "data-hx-get") == "/get-url"
        1         @test getattr(el8, "data-hx-post") == "/post-url"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # Convenience AJAX method shortcuts
        -     # ──────────────────────────────────────────────
        -     @testset "hxget!" begin
        2         el = HTMLElement(:div)
        1         result = hxget!(el, "/api/items")
        1         @test result === el
        1         @test getattr(el, "data-hx-get") == "/api/items"
        -     end
        - 
        -     @testset "hxget! edge cases" begin
        -         # Various element types
        2         for tag_sym in [:div, :button, :span, :a, :form, :input, :table, :tr, :td, :li]
       10             el = HTMLElement(tag_sym)
       10             hxget!(el, "/test")
       10             @test getattr(el, "data-hx-get") == "/test"
       10         end
        -         # URL with encoded characters
        1         el = HTMLElement(:div)
        1         hxget!(el, "/api/items?name=hello%20world&type=a%26b")
        1         @test getattr(el, "data-hx-get") == "/api/items?name=hello%20world&type=a%26b"
        -     end
        - 
        -     @testset "hxpost!" begin
        2         el = HTMLElement(:form)
        1         result = hxpost!(el, "/api/submit")
        1         @test result === el
        1         @test getattr(el, "data-hx-post") == "/api/submit"
        -     end
        - 
        -     @testset "hxpost! edge cases" begin
        2         el = HTMLElement(:button)
        1         hxpost!(el, "/api/submit?redirect=true")
        1         @test getattr(el, "data-hx-post") == "/api/submit?redirect=true"
        -     end
        - 
        -     @testset "hxput!" begin
        2         el = HTMLElement(:div)
        1         result = hxput!(el, "/api/update")
        1         @test result === el
        1         @test getattr(el, "data-hx-put") == "/api/update"
        -     end
        - 
        -     @testset "hxput! edge cases" begin
        2         el = HTMLElement(:form)
        1         hxput!(el, "/api/resource/123")
        1         @test getattr(el, "data-hx-put") == "/api/resource/123"
        -     end
        - 
        -     @testset "hxpatch!" begin
        2         el = HTMLElement(:div)
        1         result = hxpatch!(el, "/api/patch")
        1         @test result === el
        1         @test getattr(el, "data-hx-patch") == "/api/patch"
        -     end
        - 
        -     @testset "hxpatch! edge cases" begin
        2         el = HTMLElement(:span)
        1         hxpatch!(el, "/api/resource/456/field")
        1         @test getattr(el, "data-hx-patch") == "/api/resource/456/field"
        -     end
        - 
        -     @testset "hxdelete!" begin
        2         el = HTMLElement(:div)
        1         result = hxdelete!(el, "/api/remove")
        1         @test result === el
        1         @test getattr(el, "data-hx-delete") == "/api/remove"
        -     end
        - 
        -     @testset "hxdelete! edge cases" begin
        2         el = HTMLElement(:button)
        1         hxdelete!(el, "/api/resource/789")
        1         @test getattr(el, "data-hx-delete") == "/api/resource/789"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxtrigger! — basic and modifiers
        -     # ──────────────────────────────────────────────
        -     @testset "hxtrigger! basic" begin
        2         el = HTMLElement(:div)
        1         result = hxtrigger!(el, "click")
        1         @test result === el
        1         @test getattr(el, "data-hx-trigger") == "click"
        -     end
        - 
        -     @testset "hxtrigger! with filter" begin
        2         el = HTMLElement(:div)
        1         hxtrigger!(el, "click"; filter = "ctrlKey")
        1         @test getattr(el, "data-hx-trigger") == "click[ctrlKey]"
        -     end
        - 
        -     @testset "hxtrigger! with once" begin
        2         el = HTMLElement(:div)
        1         hxtrigger!(el, "click"; once = true)
        1         @test getattr(el, "data-hx-trigger") == "click once"
        -     end
        - 
        -     @testset "hxtrigger! with changed" begin
        2         el = HTMLElement(:input)
        1         hxtrigger!(el, "keyup"; changed = true)
        1         @test getattr(el, "data-hx-trigger") == "keyup changed"
        -     end
        - 
        -     @testset "hxtrigger! with delay" begin
        2         el = HTMLElement(:input)
        1         hxtrigger!(el, "keyup"; delay = "500ms")
        1         @test getattr(el, "data-hx-trigger") == "keyup delay:500ms"
        -     end
        - 
        -     @testset "hxtrigger! with throttle" begin
        2         el = HTMLElement(:div)
        1         hxtrigger!(el, "scroll"; throttle = "1s")
        1         @test getattr(el, "data-hx-trigger") == "scroll throttle:1s"
        -     end
        - 
        -     @testset "hxtrigger! with from" begin
        2         el = HTMLElement(:div)
        1         hxtrigger!(el, "click"; from = "#other-element")
        1         @test getattr(el, "data-hx-trigger") == "click from:#other-element"
        -     end
        - 
        -     @testset "hxtrigger! with target modifier" begin
        2         el = HTMLElement(:div)
        1         hxtrigger!(el, "click"; target = ".child")
        1         @test getattr(el, "data-hx-trigger") == "click target:.child"
        -     end
        - 
        -     @testset "hxtrigger! with consume" begin
        2         el = HTMLElement(:div)
        1         hxtrigger!(el, "click"; consume = true)
        1         @test getattr(el, "data-hx-trigger") == "click consume"
        -     end
        - 
        -     @testset "hxtrigger! with queue" begin
        2         el = HTMLElement(:div)
        1         hxtrigger!(el, "click"; queue = "last")
        1         @test getattr(el, "data-hx-trigger") == "click queue:last"
        - 
        1         el2 = HTMLElement(:div)
        1         hxtrigger!(el2, "click"; queue = "first")
        1         @test getattr(el2, "data-hx-trigger") == "click queue:first"
        - 
        1         el3 = HTMLElement(:div)
        1         hxtrigger!(el3, "click"; queue = "all")
        1         @test getattr(el3, "data-hx-trigger") == "click queue:all"
        - 
        1         el4 = HTMLElement(:div)
        1         hxtrigger!(el4, "click"; queue = "none")
        1         @test getattr(el4, "data-hx-trigger") == "click queue:none"
        -     end
        - 
        -     @testset "hxtrigger! with multiple modifiers" begin
        2         el = HTMLElement(:input)
        1         hxtrigger!(el, "keyup"; changed = true, delay = "500ms")
        1         @test getattr(el, "data-hx-trigger") == "keyup changed delay:500ms"
        -     end
        - 
        -     @testset "hxtrigger! with all modifiers" begin
        2         el = HTMLElement(:input)
        1         hxtrigger!(el, "keyup"; once = true, changed = true, delay = "500ms",
        -             throttle = "1s", from = "#form", target = ".input",
        -             consume = true, queue = "last", filter = "shiftKey")
        1         trigger = getattr(el, "data-hx-trigger")
        1         @test occursin("keyup[shiftKey]", trigger)
        1         @test occursin("once", trigger)
        1         @test occursin("changed", trigger)
        1         @test occursin("delay:500ms", trigger)
        1         @test occursin("throttle:1s", trigger)
        1         @test occursin("from:#form", trigger)
        1         @test occursin("target:.input", trigger)
        1         @test occursin("consume", trigger)
        1         @test occursin("queue:last", trigger)
        -     end
        - 
        -     @testset "hxtrigger! edge cases" begin
        -         # Filter only, no other modifiers
        2         el = HTMLElement(:div)
        1         hxtrigger!(el, "click"; filter = "event.detail.level === 'important'")
        1         @test getattr(el, "data-hx-trigger") == "click[event.detail.level === 'important']"
        - 
        -         # Complex JS filter expression
        1         el2 = HTMLElement(:div)
        1         hxtrigger!(el2, "keyup"; filter = "ctrlKey && shiftKey")
        1         @test getattr(el2, "data-hx-trigger") == "keyup[ctrlKey && shiftKey]"
        - 
        -         # Filter combined with single modifier
        1         el3 = HTMLElement(:div)
        1         hxtrigger!(el3, "click"; filter = "altKey", once = true)
        1         trigger = getattr(el3, "data-hx-trigger")
        1         @test occursin("click[altKey]", trigger)
        1         @test occursin("once", trigger)
        - 
        -         # All boolean modifiers false by default — should produce just event
        1         el4 = HTMLElement(:div)
        1         hxtrigger!(el4, "mouseenter"; once = false, changed = false, consume = false)
        1         @test getattr(el4, "data-hx-trigger") == "mouseenter"
        - 
        -         # Various event types
        1         for event in ["click", "mouseenter", "mouseleave", "keyup", "keydown",
        -             "change", "submit", "focus", "blur", "input"]
       10             el = HTMLElement(:div)
       10             hxtrigger!(el, event)
       10             @test getattr(el, "data-hx-trigger") == event
       10         end
        - 
        -         # from with special selectors
        1         el5 = HTMLElement(:div)
        1         hxtrigger!(el5, "click"; from = "document")
        1         @test getattr(el5, "data-hx-trigger") == "click from:document"
        - 
        1         el6 = HTMLElement(:div)
        1         hxtrigger!(el6, "click"; from = "window")
        1         @test getattr(el6, "data-hx-trigger") == "click from:window"
        - 
        1         el7 = HTMLElement(:div)
        1         hxtrigger!(el7, "click"; from = "closest div")
        1         @test getattr(el7, "data-hx-trigger") == "click from:closest div"
        - 
        -         # Overwrite trigger on same element
        1         el8 = HTMLElement(:div)
        1         hxtrigger!(el8, "click")
        1         @test getattr(el8, "data-hx-trigger") == "click"
        1         hxtrigger!(el8, "mouseenter"; once = true)
        1         @test getattr(el8, "data-hx-trigger") == "mouseenter once"
        - 
        -         # delay and throttle together
        1         el9 = HTMLElement(:input)
        1         hxtrigger!(el9, "keyup"; delay = "300ms", throttle = "2s")
        1         trigger = getattr(el9, "data-hx-trigger")
        1         @test occursin("delay:300ms", trigger)
        1         @test occursin("throttle:2s", trigger)
        - 
        -         # from and target together
        1         el10 = HTMLElement(:div)
        1         hxtrigger!(el10, "click"; from = "#source", target = ".dest")
        1         trigger = getattr(el10, "data-hx-trigger")
        1         @test occursin("from:#source", trigger)
        1         @test occursin("target:.dest", trigger)
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # Specialty triggers
        -     # ──────────────────────────────────────────────
        -     @testset "load_trigger" begin
        2         el = HTMLElement(:div)
        1         result = load_trigger(el)
        1         @test result === el
        1         @test getattr(el, "data-hx-trigger") == "load"
        - 
        1         el2 = HTMLElement(:div)
        1         load_trigger(el2; delay = "1s")
        1         @test getattr(el2, "data-hx-trigger") == "load delay:1s"
        -     end
        - 
        -     @testset "load_trigger edge cases" begin
        -         # Delay with milliseconds
        2         el = HTMLElement(:div)
        1         load_trigger(el; delay = "500ms")
        1         @test getattr(el, "data-hx-trigger") == "load delay:500ms"
        - 
        -         # No delay (nothing)
        1         el2 = HTMLElement(:div)
        1         load_trigger(el2; delay = nothing)
        1         @test getattr(el2, "data-hx-trigger") == "load"
        -     end
        - 
        -     @testset "revealed_trigger" begin
        2         el = HTMLElement(:div)
        1         result = revealed_trigger(el)
        1         @test result === el
        1         @test getattr(el, "data-hx-trigger") == "revealed once"
        - 
        1         el2 = HTMLElement(:div)
        1         revealed_trigger(el2; once = false)
        1         @test getattr(el2, "data-hx-trigger") == "revealed"
        -     end
        - 
        -     @testset "revealed_trigger edge cases" begin
        -         # Default is once=true
        2         el = HTMLElement(:section)
        1         revealed_trigger(el)
        1         @test occursin("once", getattr(el, "data-hx-trigger"))
        - 
        -         # Explicit once=true
        1         el2 = HTMLElement(:div)
        1         revealed_trigger(el2; once = true)
        1         @test getattr(el2, "data-hx-trigger") == "revealed once"
        -     end
        - 
        -     @testset "intersect_trigger" begin
        2         el = HTMLElement(:div)
        1         result = intersect_trigger(el)
        1         @test result === el
        1         @test getattr(el, "data-hx-trigger") == "intersect once"
        - 
        1         el2 = HTMLElement(:div)
        1         intersect_trigger(el2; threshold = 0.5)
        1         @test occursin("threshold:0.5", getattr(el2, "data-hx-trigger"))
        - 
        1         el3 = HTMLElement(:div)
        1         intersect_trigger(el3; root = "#viewport", threshold = 0.8, once = false)
        1         trigger = getattr(el3, "data-hx-trigger")
        1         @test occursin("root:#viewport", trigger)
        1         @test occursin("threshold:0.8", trigger)
        - 
        -         # threshold clamping
        1         el4 = HTMLElement(:div)
        1         intersect_trigger(el4; threshold = 1.5)
        1         @test occursin("threshold:1.0", getattr(el4, "data-hx-trigger"))
        - 
        1         el5 = HTMLElement(:div)
        1         intersect_trigger(el5; threshold = -0.5)
        1         @test occursin("threshold:0.0", getattr(el5, "data-hx-trigger"))
        -     end
        - 
        -     @testset "intersect_trigger edge cases" begin
        -         # Only root, no threshold
        2         el = HTMLElement(:div)
        1         intersect_trigger(el; root = "#container")
        1         trigger = getattr(el, "data-hx-trigger")
        1         @test occursin("root:#container", trigger)
        1         @test !occursin("threshold", trigger)
        - 
        -         # Threshold exactly 0
        1         el2 = HTMLElement(:div)
        1         intersect_trigger(el2; threshold = 0.0)
        1         @test occursin("threshold:0.0", getattr(el2, "data-hx-trigger"))
        - 
        -         # Threshold exactly 1
        1         el3 = HTMLElement(:div)
        1         intersect_trigger(el3; threshold = 1.0)
        1         @test occursin("threshold:1.0", getattr(el3, "data-hx-trigger"))
        - 
        -         # once=false without options
        1         el4 = HTMLElement(:div)
        1         intersect_trigger(el4; once = false)
        1         trigger = getattr(el4, "data-hx-trigger")
        1         @test startswith(trigger, "intersect")
        1         @test !occursin("once", trigger)
        - 
        -         # Threshold as integer (Real type)
        1         el5 = HTMLElement(:div)
        1         intersect_trigger(el5; threshold = 1)
        1         @test occursin("threshold:1.0", getattr(el5, "data-hx-trigger"))
        - 
        -         # Root and threshold and once=false
        1         el6 = HTMLElement(:div)
        1         intersect_trigger(el6; root = ".scroller", threshold = 0.25, once = false)
        1         trigger = getattr(el6, "data-hx-trigger")
        1         @test occursin("root:.scroller", trigger)
        1         @test occursin("threshold:0.25", trigger)
        1         @test !occursin("once", trigger)
        -     end
        - 
        -     @testset "poll_trigger" begin
        2         el = HTMLElement(:div)
        1         result = poll_trigger(el, "2s")
        1         @test result === el
        1         @test getattr(el, "data-hx-trigger") == "every 2s"
        - 
        1         el2 = HTMLElement(:div)
        1         poll_trigger(el2, "500ms")
        1         @test getattr(el2, "data-hx-trigger") == "every 500ms"
        -     end
        - 
        -     @testset "poll_trigger edge cases" begin
        -         # Various intervals
        2         for interval in ["100ms", "1s", "5s", "30s", "1m", "10m"]
        6             el = HTMLElement(:div)
        6             poll_trigger(el, interval)
        6             @test getattr(el, "data-hx-trigger") == "every $interval"
        6         end
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxtarget!
        -     # ──────────────────────────────────────────────
        -     @testset "hxtarget!" begin
        2         el = HTMLElement(:div)
        1         result = hxtarget!(el, "#results")
        1         @test result === el
        1         @test getattr(el, "data-hx-target") == "#results"
        - 
        1         el2 = HTMLElement(:input)
        1         hxtarget!(el2, "this")
        1         @test getattr(el2, "data-hx-target") == "this"
        - 
        1         el3 = HTMLElement(:div)
        1         hxtarget!(el3, "closest tr")
        1         @test getattr(el3, "data-hx-target") == "closest tr"
        - 
        1         el4 = HTMLElement(:div)
        1         hxtarget!(el4, "find .content")
        1         @test getattr(el4, "data-hx-target") == "find .content"
        - 
        1         el5 = HTMLElement(:div)
        1         hxtarget!(el5, "next .sibling")
        1         @test getattr(el5, "data-hx-target") == "next .sibling"
        - 
        1         el6 = HTMLElement(:div)
        1         hxtarget!(el6, "previous .sibling")
        1         @test getattr(el6, "data-hx-target") == "previous .sibling"
        -     end
        - 
        -     @testset "hxtarget! edge cases" begin
        -         # Complex CSS selectors
        2         el = HTMLElement(:div)
        1         hxtarget!(el, "#main > .content:first-child")
        1         @test getattr(el, "data-hx-target") == "#main > .content:first-child"
        - 
        1         el2 = HTMLElement(:div)
        1         hxtarget!(el2, "closest form")
        1         @test getattr(el2, "data-hx-target") == "closest form"
        - 
        1         el3 = HTMLElement(:div)
        1         hxtarget!(el3, "find ul > li.active")
        1         @test getattr(el3, "data-hx-target") == "find ul > li.active"
        - 
        -         # Overwriting target
        1         el4 = HTMLElement(:div)
        1         hxtarget!(el4, "#first")
        1         @test getattr(el4, "data-hx-target") == "#first"
        1         hxtarget!(el4, "#second")
        1         @test getattr(el4, "data-hx-target") == "#second"
        - 
        -         # body target
        1         el5 = HTMLElement(:div)
        1         hxtarget!(el5, "body")
        1         @test getattr(el5, "data-hx-target") == "body"
        - 
        -         # next/previous without selector
        1         el6 = HTMLElement(:div)
        1         hxtarget!(el6, "next")
        1         @test getattr(el6, "data-hx-target") == "next"
        - 
        1         el7 = HTMLElement(:div)
        1         hxtarget!(el7, "previous")
        1         @test getattr(el7, "data-hx-target") == "previous"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxswap!
        -     # ──────────────────────────────────────────────
        -     @testset "hxswap! basic" begin
        2         for style in ["innerHTML", "outerHTML", "afterbegin", "beforebegin",
        -             "beforeend", "afterend", "delete", "none"]
        8             el = HTMLElement(:div)
        8             result = hxswap!(el, style)
        8             @test result === el
        8             @test getattr(el, "data-hx-swap") == style
        8         end
        -     end
        - 
        -     @testset "hxswap! VALID_SWAP_STYLES constant" begin
        -         # Ensure all styles in the constant are valid
        2         @test "innerHTML" in VALID_SWAP_STYLES
        1         @test "outerHTML" in VALID_SWAP_STYLES
        1         @test "afterbegin" in VALID_SWAP_STYLES
        1         @test "beforebegin" in VALID_SWAP_STYLES
        1         @test "beforeend" in VALID_SWAP_STYLES
        1         @test "afterend" in VALID_SWAP_STYLES
        1         @test "delete" in VALID_SWAP_STYLES
        1         @test "none" in VALID_SWAP_STYLES
        1         @test length(VALID_SWAP_STYLES) == 8
        -     end
        - 
        -     @testset "hxswap! with modifiers" begin
        2         el = HTMLElement(:div)
        1         hxswap!(el, "outerHTML"; transition = true)
        1         @test getattr(el, "data-hx-swap") == "outerHTML transition:true"
        - 
        1         el2 = HTMLElement(:div)
        1         hxswap!(el2, "innerHTML"; swap = "100ms")
        1         @test getattr(el2, "data-hx-swap") == "innerHTML swap:100ms"
        - 
        1         el3 = HTMLElement(:div)
        1         hxswap!(el3, "innerHTML"; settle = "200ms")
        1         @test getattr(el3, "data-hx-swap") == "innerHTML settle:200ms"
        - 
        1         el4 = HTMLElement(:div)
        1         hxswap!(el4, "outerHTML"; ignoreTitle = true)
        1         @test getattr(el4, "data-hx-swap") == "outerHTML ignoreTitle:true"
        - 
        1         el5 = HTMLElement(:div)
        1         hxswap!(el5, "innerHTML"; scroll = "top")
        1         @test getattr(el5, "data-hx-swap") == "innerHTML scroll:top"
        - 
        1         el6 = HTMLElement(:div)
        1         hxswap!(el6, "innerHTML"; show = "bottom")
        1         @test getattr(el6, "data-hx-swap") == "innerHTML show:bottom"
        - 
        1         el7 = HTMLElement(:div)
        1         hxswap!(el7, "innerHTML"; focusScroll = false)
        1         @test getattr(el7, "data-hx-swap") == "innerHTML focus-scroll:false"
        -     end
        - 
        -     @testset "hxswap! with modifiers edge cases" begin
        -         # transition: false
        2         el = HTMLElement(:div)
        1         hxswap!(el, "innerHTML"; transition = false)
        1         @test getattr(el, "data-hx-swap") == "innerHTML transition:false"
        - 
        -         # ignoreTitle: false
        1         el2 = HTMLElement(:div)
        1         hxswap!(el2, "innerHTML"; ignoreTitle = false)
        1         @test getattr(el2, "data-hx-swap") == "innerHTML ignoreTitle:false"
        - 
        -         # focusScroll: true
        1         el3 = HTMLElement(:div)
        1         hxswap!(el3, "innerHTML"; focusScroll = true)
        1         @test getattr(el3, "data-hx-swap") == "innerHTML focus-scroll:true"
        - 
        -         # scroll: "bottom"
        1         el4 = HTMLElement(:div)
        1         hxswap!(el4, "innerHTML"; scroll = "bottom")
        1         @test getattr(el4, "data-hx-swap") == "innerHTML scroll:bottom"
        - 
        -         # show: "top"
        1         el5 = HTMLElement(:div)
        1         hxswap!(el5, "innerHTML"; show = "top")
        1         @test getattr(el5, "data-hx-swap") == "innerHTML show:top"
        - 
        -         # All modifiers combined
        1         el6 = HTMLElement(:div)
        1         hxswap!(el6, "outerHTML";
        -             transition = true,
        -             swap = "50ms",
        -             settle = "100ms",
        -             ignoreTitle = true,
        -             scroll = "top",
        -             show = "bottom",
        -             focusScroll = false)
        1         swap_val = getattr(el6, "data-hx-swap")
        1         @test startswith(swap_val, "outerHTML")
        1         @test occursin("transition:true", swap_val)
        1         @test occursin("swap:50ms", swap_val)
        1         @test occursin("settle:100ms", swap_val)
        1         @test occursin("ignoreTitle:true", swap_val)
        1         @test occursin("scroll:top", swap_val)
        1         @test occursin("show:bottom", swap_val)
        1         @test occursin("focus-scroll:false", swap_val)
        - 
        -         # No modifiers passed (all nothing/default)
        1         el7 = HTMLElement(:div)
        1         hxswap!(el7, "delete")
        1         @test getattr(el7, "data-hx-swap") == "delete"
        - 
        -         # Swap with "none" style + modifiers
        1         el8 = HTMLElement(:div)
        1         hxswap!(el8, "none"; focusScroll = false)
        1         @test getattr(el8, "data-hx-swap") == "none focus-scroll:false"
        -     end
        - 
        -     @testset "hxswap! with multiple modifiers" begin
        2         el = HTMLElement(:div)
        1         hxswap!(el, "outerHTML"; transition = true, swap = "100ms",
        -             settle = "200ms", ignoreTitle = true)
        1         swap_val = getattr(el, "data-hx-swap")
        1         @test startswith(swap_val, "outerHTML")
        1         @test occursin("transition:true", swap_val)
        1         @test occursin("swap:100ms", swap_val)
        1         @test occursin("settle:200ms", swap_val)
        1         @test occursin("ignoreTitle:true", swap_val)
        -     end
        - 
        -     @testset "hxswap! invalid style" begin
        3         el = HTMLElement(:div)
        3         @test_throws ArgumentError hxswap!(el, "invalid")
        -     end
        - 
        -     @testset "hxswap! invalid style error message" begin
        8         el = HTMLElement(:div)
        1         try
        1             hxswap!(el, "badstyle")
        0             @test false  # Should not reach here
        -         catch e
        1             @test e isa ArgumentError
        1             @test occursin("badstyle", e.msg)
        2             @test occursin("Invalid swap style", e.msg)
        -         end
        - 
        -         # Various invalid styles
        1         for bad in ["innerhtml", "outer", "INNERHTML", "append", "prepend", "replace"]
        6             el = HTMLElement(:div)
       18             @test_throws ArgumentError hxswap!(el, bad)
        6         end
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxswapoob!
        -     # ──────────────────────────────────────────────
        -     @testset "hxswapoob!" begin
        2         el = HTMLElement(:div)
        1         result = hxswapoob!(el)
        1         @test result === el
        1         @test getattr(el, "data-hx-swap-oob") == "true"
        - 
        1         el2 = HTMLElement(:div)
        1         hxswapoob!(el2, "innerHTML:#target")
        1         @test getattr(el2, "data-hx-swap-oob") == "innerHTML:#target"
        -     end
        - 
        -     @testset "hxswapoob! edge cases" begin
        -         # Various swap styles with selectors
        2         el = HTMLElement(:div)
        1         hxswapoob!(el, "outerHTML:#notifications")
        1         @test getattr(el, "data-hx-swap-oob") == "outerHTML:#notifications"
        - 
        1         el2 = HTMLElement(:div)
        1         hxswapoob!(el2, "afterbegin:#messages")
        1         @test getattr(el2, "data-hx-swap-oob") == "afterbegin:#messages"
        - 
        1         el3 = HTMLElement(:div)
        1         hxswapoob!(el3, "beforeend:.container")
        1         @test getattr(el3, "data-hx-swap-oob") == "beforeend:.container"
        - 
        -         # Default value "true"
        1         el4 = HTMLElement(:span)
        1         hxswapoob!(el4)
        1         @test getattr(el4, "data-hx-swap-oob") == "true"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxselect! / hxselectoob!
        -     # ──────────────────────────────────────────────
        -     @testset "hxselect!" begin
        2         el = HTMLElement(:div)
        1         result = hxselect!(el, "#content")
        1         @test result === el
        1         @test getattr(el, "data-hx-select") == "#content"
        -     end
        - 
        -     @testset "hxselect! edge cases" begin
        -         # Complex selectors
        2         el = HTMLElement(:div)
        1         hxselect!(el, ".main-content > article:first-of-type")
        1         @test getattr(el, "data-hx-select") == ".main-content > article:first-of-type"
        - 
        1         el2 = HTMLElement(:div)
        1         hxselect!(el2, "table tbody tr")
        1         @test getattr(el2, "data-hx-select") == "table tbody tr"
        -     end
        - 
        -     @testset "hxselectoob!" begin
        2         el = HTMLElement(:div)
        1         result = hxselectoob!(el, "#info-details,#other-elt")
        1         @test result === el
        1         @test getattr(el, "data-hx-select-oob") == "#info-details,#other-elt"
        -     end
        - 
        -     @testset "hxselectoob! edge cases" begin
        -         # Single selector
        2         el = HTMLElement(:div)
        1         hxselectoob!(el, "#single")
        1         @test getattr(el, "data-hx-select-oob") == "#single"
        - 
        -         # Multiple comma-separated selectors
        1         el2 = HTMLElement(:div)
        1         hxselectoob!(el2, "#a,#b,#c,#d")
        1         @test getattr(el2, "data-hx-select-oob") == "#a,#b,#c,#d"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxvals!
        -     # ──────────────────────────────────────────────
        -     @testset "hxvals!" begin
        2         el = HTMLElement(:div)
        1         result = hxvals!(el, "{\"myVal\": \"test\"}")
        1         @test result === el
        1         @test getattr(el, "data-hx-vals") == "{\"myVal\": \"test\"}"
        -     end
        - 
        -     @testset "hxvals! edge cases" begin
        -         # Multiple values
        2         el = HTMLElement(:div)
        1         hxvals!(el, "{\"key1\": \"val1\", \"key2\": 42, \"key3\": true}")
        1         @test getattr(el, "data-hx-vals") ==
        -               "{\"key1\": \"val1\", \"key2\": 42, \"key3\": true}"
        - 
        -         # JS: prefix for dynamic values
        1         el2 = HTMLElement(:div)
        1         hxvals!(el2, "js:{myVal: calculateValue()}")
        1         @test getattr(el2, "data-hx-vals") == "js:{myVal: calculateValue()}"
        - 
        -         # Empty object
        1         el3 = HTMLElement(:div)
        1         hxvals!(el3, "{}")
        1         @test getattr(el3, "data-hx-vals") == "{}"
        - 
        -         # Nested JSON
        1         el4 = HTMLElement(:div)
        1         hxvals!(el4, "{\"outer\": {\"inner\": \"value\"}}")
        1         @test getattr(el4, "data-hx-vals") == "{\"outer\": {\"inner\": \"value\"}}"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxpushurl! / hxreplaceurl!
        -     # ──────────────────────────────────────────────
        -     @testset "hxpushurl!" begin
        2         el = HTMLElement(:a)
        1         result = hxpushurl!(el)
        1         @test result === el
        1         @test getattr(el, "data-hx-push-url") == "true"
        - 
        1         el2 = HTMLElement(:a)
        1         hxpushurl!(el2, "/custom-url")
        1         @test getattr(el2, "data-hx-push-url") == "/custom-url"
        - 
        1         el3 = HTMLElement(:a)
        1         hxpushurl!(el3, "false")
        1         @test getattr(el3, "data-hx-push-url") == "false"
        -     end
        - 
        -     @testset "hxpushurl! edge cases" begin
        -         # URL with query params
        2         el = HTMLElement(:a)
        1         hxpushurl!(el, "/search?q=test&page=2")
        1         @test getattr(el, "data-hx-push-url") == "/search?q=test&page=2"
        - 
        -         # Full URL
        1         el2 = HTMLElement(:a)
        1         hxpushurl!(el2, "https://example.com/page")
        1         @test getattr(el2, "data-hx-push-url") == "https://example.com/page"
        -     end
        - 
        -     @testset "hxreplaceurl!" begin
        2         el = HTMLElement(:a)
        1         result = hxreplaceurl!(el)
        1         @test result === el
        1         @test getattr(el, "data-hx-replace-url") == "true"
        - 
        1         el2 = HTMLElement(:a)
        1         hxreplaceurl!(el2, "/new-url")
        1         @test getattr(el2, "data-hx-replace-url") == "/new-url"
        -     end
        - 
        -     @testset "hxreplaceurl! edge cases" begin
        -         # "false" value
        2         el = HTMLElement(:a)
        1         hxreplaceurl!(el, "false")
        1         @test getattr(el, "data-hx-replace-url") == "false"
        - 
        -         # Custom URL with hash
        1         el2 = HTMLElement(:a)
        1         hxreplaceurl!(el2, "/page#section")
        1         @test getattr(el2, "data-hx-replace-url") == "/page#section"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxconfirm! / hxprompt!
        -     # ──────────────────────────────────────────────
        -     @testset "hxconfirm!" begin
        2         el = HTMLElement(:button)
        1         result = hxconfirm!(el, "Are you sure?")
        1         @test result === el
        1         @test getattr(el, "data-hx-confirm") == "Are you sure?"
        -     end
        - 
        -     @testset "hxconfirm! edge cases" begin
        -         # Long message with special characters
        2         el = HTMLElement(:button)
        1         hxconfirm!(el, "Delete item #42? This can't be undone & will remove all data.")
        1         @test getattr(el, "data-hx-confirm") ==
        -               "Delete item #42? This can't be undone & will remove all data."
        - 
        -         # Multilingual message
        1         el2 = HTMLElement(:button)
        1         hxconfirm!(el2, "Voulez-vous continuer?")
        1         @test getattr(el2, "data-hx-confirm") == "Voulez-vous continuer?"
        -     end
        - 
        -     @testset "hxprompt!" begin
        2         el = HTMLElement(:button)
        1         result = hxprompt!(el, "Enter a value")
        1         @test result === el
        1         @test getattr(el, "data-hx-prompt") == "Enter a value"
        -     end
        - 
        -     @testset "hxprompt! edge cases" begin
        -         # Message with special characters
        2         el = HTMLElement(:button)
        1         hxprompt!(el, "Enter your name (first & last):")
        1         @test getattr(el, "data-hx-prompt") == "Enter your name (first & last):"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxindicator!
        -     # ──────────────────────────────────────────────
        -     @testset "hxindicator!" begin
        2         el = HTMLElement(:button)
        1         result = hxindicator!(el, "#spinner")
        1         @test result === el
        1         @test getattr(el, "data-hx-indicator") == "#spinner"
        -     end
        - 
        -     @testset "hxindicator! edge cases" begin
        -         # Various CSS selectors
        2         el = HTMLElement(:div)
        1         hxindicator!(el, ".loading-spinner")
        1         @test getattr(el, "data-hx-indicator") == ".loading-spinner"
        - 
        1         el2 = HTMLElement(:div)
        1         hxindicator!(el2, "closest .indicator")
        1         @test getattr(el2, "data-hx-indicator") == "closest .indicator"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxboost!
        -     # ──────────────────────────────────────────────
        -     @testset "hxboost!" begin
        2         el = HTMLElement(:div)
        1         result = hxboost!(el)
        1         @test result === el
        1         @test getattr(el, "data-hx-boost") == "true"
        - 
        1         el2 = HTMLElement(:div)
        1         hxboost!(el2, "false")
        1         @test getattr(el2, "data-hx-boost") == "false"
        -     end
        - 
        -     @testset "hxboost! edge cases" begin
        -         # On various semantic elements
        2         for tag_sym in [:nav, :main, :section, :article, :div]
        5             el = HTMLElement(tag_sym)
        5             hxboost!(el)
        5             @test getattr(el, "data-hx-boost") == "true"
        5         end
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxinclude! / hxparams!
        -     # ──────────────────────────────────────────────
        -     @testset "hxinclude!" begin
        2         el = HTMLElement(:div)
        1         result = hxinclude!(el, "[name='email']")
        1         @test result === el
        1         @test getattr(el, "data-hx-include") == "[name='email']"
        -     end
        - 
        -     @testset "hxinclude! edge cases" begin
        -         # Various selector types
        2         el = HTMLElement(:div)
        1         hxinclude!(el, "#other-form")
        1         @test getattr(el, "data-hx-include") == "#other-form"
        - 
        1         el2 = HTMLElement(:div)
        1         hxinclude!(el2, "this")
        1         @test getattr(el2, "data-hx-include") == "this"
        - 
        1         el3 = HTMLElement(:div)
        1         hxinclude!(el3, "closest form")
        1         @test getattr(el3, "data-hx-include") == "closest form"
        -     end
        - 
        -     @testset "hxparams!" begin
        2         el = HTMLElement(:div)
        1         result = hxparams!(el, "*")
        1         @test result === el
        1         @test getattr(el, "data-hx-params") == "*"
        - 
        1         el2 = HTMLElement(:div)
        1         hxparams!(el2, "none")
        1         @test getattr(el2, "data-hx-params") == "none"
        - 
        1         el3 = HTMLElement(:div)
        1         hxparams!(el3, "not secret")
        1         @test getattr(el3, "data-hx-params") == "not secret"
        -     end
        - 
        -     @testset "hxparams! edge cases" begin
        -         # Comma-separated parameter list
        2         el = HTMLElement(:div)
        1         hxparams!(el, "name,email,age")
        1         @test getattr(el, "data-hx-params") == "name,email,age"
        - 
        -         # "not" with multiple excluded params
        1         el2 = HTMLElement(:div)
        1         hxparams!(el2, "not secret,token,password")
        1         @test getattr(el2, "data-hx-params") == "not secret,token,password"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxheaders!
        -     # ──────────────────────────────────────────────
        -     @testset "hxheaders!" begin
        2         el = HTMLElement(:div)
        1         result = hxheaders!(el, "{\"X-CSRF-Token\": \"abc123\"}")
        1         @test result === el
        1         @test getattr(el, "data-hx-headers") == "{\"X-CSRF-Token\": \"abc123\"}"
        -     end
        - 
        -     @testset "hxheaders! edge cases" begin
        -         # Multiple headers
        2         el = HTMLElement(:div)
        1         hxheaders!(el, "{\"Authorization\": \"Bearer token123\", \"X-Custom\": \"value\"}")
        1         @test getattr(el, "data-hx-headers") ==
        -               "{\"Authorization\": \"Bearer token123\", \"X-Custom\": \"value\"}"
        - 
        -         # JS: prefix for dynamic headers
        1         el2 = HTMLElement(:div)
        1         hxheaders!(el2, "js:{\"X-Token\": getToken()}")
        1         @test getattr(el2, "data-hx-headers") == "js:{\"X-Token\": getToken()}"
        - 
        -         # Empty headers
        1         el3 = HTMLElement(:div)
        1         hxheaders!(el3, "{}")
        1         @test getattr(el3, "data-hx-headers") == "{}"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxsync!
        -     # ──────────────────────────────────────────────
        -     @testset "hxsync!" begin
        2         el = HTMLElement(:input)
        1         result = hxsync!(el, "closest form:abort")
        1         @test result === el
        1         @test getattr(el, "data-hx-sync") == "closest form:abort"
        - 
        1         el2 = HTMLElement(:div)
        1         hxsync!(el2, "this:drop")
        1         @test getattr(el2, "data-hx-sync") == "this:drop"
        - 
        1         el3 = HTMLElement(:div)
        1         hxsync!(el3, "this:queue last")
        1         @test getattr(el3, "data-hx-sync") == "this:queue last"
        -     end
        - 
        -     @testset "hxsync! edge cases" begin
        -         # All sync strategies
        2         for strategy in ["this:drop", "this:abort", "this:replace",
        -             "this:queue first", "this:queue last", "this:queue all"]
        6             el = HTMLElement(:div)
        6             hxsync!(el, strategy)
        6             @test getattr(el, "data-hx-sync") == strategy
        6         end
        - 
        -         # Closest with selector
        1         el = HTMLElement(:div)
        1         hxsync!(el, "closest div:replace")
        1         @test getattr(el, "data-hx-sync") == "closest div:replace"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxencoding!
        -     # ──────────────────────────────────────────────
        -     @testset "hxencoding!" begin
        2         el = HTMLElement(:form)
        1         result = hxencoding!(el)
        1         @test result === el
        1         @test getattr(el, "data-hx-encoding") == "multipart/form-data"
        - 
        1         el2 = HTMLElement(:form)
        1         hxencoding!(el2, "application/x-www-form-urlencoded")
        1         @test getattr(el2, "data-hx-encoding") == "application/x-www-form-urlencoded"
        -     end
        - 
        -     @testset "hxencoding! edge cases" begin
        -         # Default value via no-arg
        2         el = HTMLElement(:form)
        1         hxencoding!(el)
        1         @test getattr(el, "data-hx-encoding") == "multipart/form-data"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxext!
        -     # ──────────────────────────────────────────────
        -     @testset "hxext!" begin
        2         el = HTMLElement(:body)
        1         result = hxext!(el, "response-targets")
        1         @test result === el
        1         @test getattr(el, "data-hx-ext") == "response-targets"
        - 
        1         el2 = HTMLElement(:div)
        1         hxext!(el2, "ignore:response-targets")
        1         @test getattr(el2, "data-hx-ext") == "ignore:response-targets"
        - 
        1         el3 = HTMLElement(:body)
        1         hxext!(el3, "response-targets,head-support")
        1         @test getattr(el3, "data-hx-ext") == "response-targets,head-support"
        -     end
        - 
        -     @testset "hxext! edge cases" begin
        -         # Single extension
        2         for ext in ["json-enc", "morphdom-swap", "alpine-morph",
        -             "class-tools", "loading-states", "path-deps",
        -             "multi-swap", "restored", "sse", "ws"]
       10             el = HTMLElement(:body)
       10             hxext!(el, ext)
       10             @test getattr(el, "data-hx-ext") == ext
       10         end
        - 
        -         # Multiple ignore
        1         el = HTMLElement(:div)
        1         hxext!(el, "ignore:sse,ignore:ws")
        1         @test getattr(el, "data-hx-ext") == "ignore:sse,ignore:ws"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxon!
        -     # ──────────────────────────────────────────────
        -     @testset "hxon!" begin
        2         el = HTMLElement(:button)
        1         result = hxon!(el, "click", "alert('clicked')")
        1         @test result === el
        1         @test getattr(el, "data-hx-on:click") == "alert('clicked')"
        - 
        1         el2 = HTMLElement(:button)
        1         hxon!(el2, "htmx:before-request", "console.log('requesting')")
        1         @test getattr(el2, "data-hx-on:htmx:before-request") == "console.log('requesting')"
        - 
        1         el3 = HTMLElement(:button)
        1         hxon!(el3, "htmx:config-request", "event.detail.parameters.example = 'Hello'")
        1         @test getattr(el3, "data-hx-on:htmx:config-request") ==
        -               "event.detail.parameters.example = 'Hello'"
        -     end
        - 
        -     @testset "hxon! edge cases" begin
        -         # Multiple event handlers on same element
        2         el = HTMLElement(:button)
        1         hxon!(el, "click", "handleClick()")
        1         hxon!(el, "mouseenter", "handleHover()")
        1         @test getattr(el, "data-hx-on:click") == "handleClick()"
        1         @test getattr(el, "data-hx-on:mouseenter") == "handleHover()"
        - 
        -         # htmx lifecycle events
        1         for event in ["htmx:before-request", "htmx:after-request",
        -             "htmx:before-swap", "htmx:after-swap",
        -             "htmx:before-settle", "htmx:after-settle",
        -             "htmx:load", "htmx:xhr:loadend"]
        8             el = HTMLElement(:div)
        8             hxon!(el, event, "console.log('event')")
        8             @test getattr(el, "data-hx-on:$event") == "console.log('event')"
        8         end
        - 
        -         # Multi-line script
        1         el2 = HTMLElement(:form)
        1         script = "if (event.detail.successful) { alert('Success!'); } else { alert('Failed'); }"
        1         hxon!(el2, "htmx:after-request", script)
        1         @test getattr(el2, "data-hx-on:htmx:after-request") == script
        - 
        -         # Standard DOM events
        1         for event in ["click", "dblclick", "mousedown", "mouseup",
        -             "keydown", "keyup", "keypress", "submit",
        -             "change", "input", "focus", "blur"]
       12             el = HTMLElement(:div)
       12             hxon!(el, event, "handler()")
       12             @test getattr(el, "data-hx-on:$event") == "handler()"
       12         end
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxdisable! / hxdisabledelt!
        -     # ──────────────────────────────────────────────
        -     @testset "hxdisable!" begin
        2         el = HTMLElement(:div)
        1         result = hxdisable!(el)
        1         @test result === el
        2         @test hasattr(el, "data-hx-disable")
        -     end
        - 
        -     @testset "hxdisable! edge cases" begin
        -         # Verify the value is empty string
        2         el = HTMLElement(:div)
        1         hxdisable!(el)
        1         @test getattr(el, "data-hx-disable") == ""
        - 
        -         # Can be applied to any element type
        1         for tag_sym in [:div, :form, :section, :article, :span]
        5             el = HTMLElement(tag_sym)
        5             hxdisable!(el)
       10             @test hasattr(el, "data-hx-disable")
        5             @test getattr(el, "data-hx-disable") == ""
        5         end
        -     end
        - 
        -     @testset "hxdisabledelt!" begin
        2         el = HTMLElement(:form)
        1         result = hxdisabledelt!(el, "this")
        1         @test result === el
        1         @test getattr(el, "data-hx-disabled-elt") == "this"
        - 
        1         el2 = HTMLElement(:form)
        1         hxdisabledelt!(el2, "closest button")
        1         @test getattr(el2, "data-hx-disabled-elt") == "closest button"
        -     end
        - 
        -     @testset "hxdisabledelt! edge cases" begin
        -         # Various selectors
        2         el = HTMLElement(:form)
        1         hxdisabledelt!(el, "#submit-btn")
        1         @test getattr(el, "data-hx-disabled-elt") == "#submit-btn"
        - 
        1         el2 = HTMLElement(:form)
        1         hxdisabledelt!(el2, "find button")
        1         @test getattr(el2, "data-hx-disabled-elt") == "find button"
        - 
        -         # Multiple selectors (comma separated)
        1         el3 = HTMLElement(:form)
        1         hxdisabledelt!(el3, "#btn1, #btn2")
        1         @test getattr(el3, "data-hx-disabled-elt") == "#btn1, #btn2"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxdisinherit! / hxinherit!
        -     # ──────────────────────────────────────────────
        -     @testset "hxdisinherit!" begin
        2         el = HTMLElement(:div)
        1         result = hxdisinherit!(el, "*")
        1         @test result === el
        1         @test getattr(el, "data-hx-disinherit") == "*"
        - 
        1         el2 = HTMLElement(:div)
        1         hxdisinherit!(el2, "hx-target hx-swap")
        1         @test getattr(el2, "data-hx-disinherit") == "hx-target hx-swap"
        -     end
        - 
        -     @testset "hxdisinherit! edge cases" begin
        -         # Single attribute
        2         el = HTMLElement(:div)
        1         hxdisinherit!(el, "hx-get")
        1         @test getattr(el, "data-hx-disinherit") == "hx-get"
        - 
        -         # Multiple attributes
        1         el2 = HTMLElement(:div)
        1         hxdisinherit!(el2, "hx-target hx-swap hx-trigger hx-vals")
        1         @test getattr(el2, "data-hx-disinherit") == "hx-target hx-swap hx-trigger hx-vals"
        -     end
        - 
        -     @testset "hxinherit!" begin
        2         el = HTMLElement(:div)
        1         result = hxinherit!(el, "*")
        1         @test result === el
        1         @test getattr(el, "data-hx-inherit") == "*"
        - 
        1         el2 = HTMLElement(:div)
        1         hxinherit!(el2, "hx-target hx-swap")
        1         @test getattr(el2, "data-hx-inherit") == "hx-target hx-swap"
        -     end
        - 
        -     @testset "hxinherit! edge cases" begin
        -         # Single attribute
        2         el = HTMLElement(:div)
        1         hxinherit!(el, "hx-get")
        1         @test getattr(el, "data-hx-inherit") == "hx-get"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxhistory! / hxhistoryelt!
        -     # ──────────────────────────────────────────────
        -     @testset "hxhistory!" begin
        2         el = HTMLElement(:div)
        1         result = hxhistory!(el)
        1         @test result === el
        1         @test getattr(el, "data-hx-history") == "false"
        - 
        1         el2 = HTMLElement(:div)
        1         hxhistory!(el2, "true")
        1         @test getattr(el2, "data-hx-history") == "true"
        -     end
        - 
        -     @testset "hxhistory! edge cases" begin
        -         # Default value is "false"
        2         el = HTMLElement(:body)
        1         hxhistory!(el)
        1         @test getattr(el, "data-hx-history") == "false"
        -     end
        - 
        -     @testset "hxhistoryelt!" begin
        2         el = HTMLElement(:div)
        1         result = hxhistoryelt!(el)
        1         @test result === el
        2         @test hasattr(el, "data-hx-history-elt")
        -     end
        - 
        -     @testset "hxhistoryelt! edge cases" begin
        -         # Verify empty string value
        2         el = HTMLElement(:div)
        1         hxhistoryelt!(el)
        1         @test getattr(el, "data-hx-history-elt") == ""
        - 
        -         # Applied to main content element
        1         el2 = HTMLElement(:main)
        1         hxhistoryelt!(el2)
        2         @test hasattr(el2, "data-hx-history-elt")
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxpreserve!
        -     # ──────────────────────────────────────────────
        -     @testset "hxpreserve!" begin
        2         el = HTMLElement(:div)
        1         result = hxpreserve!(el)
        1         @test result === el
        2         @test hasattr(el, "data-hx-preserve")
        -     end
        - 
        -     @testset "hxpreserve! edge cases" begin
        -         # Verify empty string value
        2         el = HTMLElement(:div)
        1         hxpreserve!(el)
        1         @test getattr(el, "data-hx-preserve") == ""
        - 
        -         # Typical usage: video/audio elements
        1         el2 = HTMLElement(:video)
        1         el2["id"] = "main-video"
        1         hxpreserve!(el2)
        2         @test hasattr(el2, "data-hx-preserve")
        1         @test getattr(el2, "id") == "main-video"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxrequestconfig!
        -     # ──────────────────────────────────────────────
        -     @testset "hxrequestconfig!" begin
        2         el = HTMLElement(:div)
        1         result = hxrequestconfig!(el, "timeout:3000")
        1         @test result === el
        1         @test getattr(el, "data-hx-request") == "timeout:3000"
        - 
        1         el2 = HTMLElement(:div)
        1         hxrequestconfig!(el2, "credentials:true")
        1         @test getattr(el2, "data-hx-request") == "credentials:true"
        - 
        1         el3 = HTMLElement(:div)
        1         hxrequestconfig!(el3, "noHeaders:true")
        1         @test getattr(el3, "data-hx-request") == "noHeaders:true"
        -     end
        - 
        -     @testset "hxrequestconfig! edge cases" begin
        -         # Multiple config values
        2         el = HTMLElement(:div)
        1         hxrequestconfig!(el, "timeout:5000, credentials:true")
        1         @test getattr(el, "data-hx-request") == "timeout:5000, credentials:true"
        - 
        -         # JSON-style config
        1         el2 = HTMLElement(:div)
        1         hxrequestconfig!(el2, "{\"timeout\": 10000}")
        1         @test getattr(el2, "data-hx-request") == "{\"timeout\": 10000}"
        -     end
        - 
        -     # ──────────────────────────────────────────────
        -     # hxvalidate!
        -     # ──────────────────────────────────────────────
        -     @testset "hxvalidate!" begin
        2         el = HTMLElement(:div)
        1         result = hxvalidate!(el)
        1         @test result === el
        1         @test getattr(el, "data-hx-validate") == "true"
        -     end
        - 
        -     @testset "hxvalidate! edge cases" begin
        -         # On form element
        2         el = HTMLElement(:form)
        1         hxvalidate!(el)
        1         @test getattr(el, "data-hx-validate") == "true"
        - 
        -         # On input element
        1         el2 = HTMLElement(:input)
        1         hxvalidate!(el2)
        1         @test getattr(el2, "data-hx-validate") == "true"
        -     end
        - 
        -     # ══════════════════════════════════════════════
        -     # Combined / Integration tests
        -     # ══════════════════════════════════════════════
        -     @testset "combined hx attributes" begin
        2         el = HTMLElement(:button)
        1         hxget!(el, "/api/data")
        1         hxtrigger!(el, "click"; once = true)
        1         @test getattr(el, "data-hx-get") == "/api/data"
        1         @test getattr(el, "data-hx-trigger") == "click once"
        -     end
        - 
        -     @testset "full htmx example: active search" begin
        2         el = HTMLElement(:input)
        1         hxget!(el, "/search")
        1         hxtrigger!(el, "keyup"; changed = true, delay = "500ms")
        1         hxtarget!(el, "#search-results")
        1         hxindicator!(el, ".htmx-indicator")
        1         @test getattr(el, "data-hx-get") == "/search"
        1         @test getattr(el, "data-hx-trigger") == "keyup changed delay:500ms"
        1         @test getattr(el, "data-hx-target") == "#search-results"
        1         @test getattr(el, "data-hx-indicator") == ".htmx-indicator"
        -     end
        - 
        -     @testset "full htmx example: delete with confirm" begin
        2         el = HTMLElement(:button)
        1         hxdelete!(el, "/account")
        1         hxconfirm!(el, "Are you sure you wish to delete your account?")
        1         hxswap!(el, "outerHTML")
        1         @test getattr(el, "data-hx-delete") == "/account"
        1         @test getattr(el, "data-hx-confirm") ==
        -               "Are you sure you wish to delete your account?"
        1         @test getattr(el, "data-hx-swap") == "outerHTML"
        -     end
        - 
        -     @testset "full htmx example: boosted navigation" begin
        2         el = HTMLElement(:div)
        1         hxboost!(el)
        1         @test getattr(el, "data-hx-boost") == "true"
        -     end
        - 
        -     @testset "full htmx example: form with sync" begin
        2         input = HTMLElement(:input)
        1         hxpost!(input, "/validate")
        1         hxtrigger!(input, "change")
        1         hxsync!(input, "closest form:abort")
        1         @test getattr(input, "data-hx-post") == "/validate"
        1         @test getattr(input, "data-hx-trigger") == "change"
        1         @test getattr(input, "data-hx-sync") == "closest form:abort"
        -     end
        - 
        -     @testset "full htmx example: history push" begin
        2         el = HTMLElement(:a)
        1         hxget!(el, "/blog")
        1         hxpushurl!(el)
        1         @test getattr(el, "data-hx-get") == "/blog"
        1         @test getattr(el, "data-hx-push-url") == "true"
        -     end
        - 
        -     @testset "full htmx example: file upload" begin
        2         el = HTMLElement(:form)
        1         hxpost!(el, "/upload")
        1         hxencoding!(el)
        1         @test getattr(el, "data-hx-post") == "/upload"
        1         @test getattr(el, "data-hx-encoding") == "multipart/form-data"
        -     end
        - 
        -     @testset "full htmx example: CSRF headers" begin
        2         el = HTMLElement(:body)
        1         hxheaders!(el, "{\"X-CSRF-TOKEN\": \"abc123\"}")
        1         @test getattr(el, "data-hx-headers") == "{\"X-CSRF-TOKEN\": \"abc123\"}"
        -     end
        - 
        -     @testset "full htmx example: with extensions" begin
        2         el = HTMLElement(:body)
        1         hxext!(el, "response-targets")
        1         @test getattr(el, "data-hx-ext") == "response-targets"
        -     end
        - 
        -     @testset "full htmx example: inline event handler" begin
        2         el = HTMLElement(:button)
        1         hxpost!(el, "/example")
        1         hxon!(el, "htmx:config-request", "event.detail.parameters.example = 'Hello'")
        1         @test getattr(el, "data-hx-post") == "/example"
        1         @test getattr(el, "data-hx-on:htmx:config-request") ==
        -               "event.detail.parameters.example = 'Hello'"
        -     end
        - 
        -     @testset "full htmx example: out of band swap" begin
        2         el = HTMLElement(:div)
        1         el["id"] = "message"
        1         hxswapoob!(el)
        1         @test getattr(el, "id") == "message"
        1         @test getattr(el, "data-hx-swap-oob") == "true"
        -     end
        - 
        -     # ══════════════════════════════════════════════
        -     # Advanced integration / edge case scenarios
        -     # ══════════════════════════════════════════════
        -     @testset "attribute overwrite: calling same setter twice" begin
        2         el = HTMLElement(:button)
        1         hxget!(el, "/first")
        1         @test getattr(el, "data-hx-get") == "/first"
        1         hxget!(el, "/second")
        1         @test getattr(el, "data-hx-get") == "/second"
        - 
        1         el2 = HTMLElement(:div)
        1         hxtarget!(el2, "#old")
        1         hxtarget!(el2, "#new")
        1         @test getattr(el2, "data-hx-target") == "#new"
        - 
        1         el3 = HTMLElement(:div)
        1         hxswap!(el3, "innerHTML")
        1         hxswap!(el3, "outerHTML")
        1         @test getattr(el3, "data-hx-swap") == "outerHTML"
        -     end
        - 
        -     @testset "element with many htmx attributes" begin
        2         el = HTMLElement(:button)
        1         hxpost!(el, "/submit")
        1         hxtrigger!(el, "click"; once = true)
        1         hxtarget!(el, "#result")
        1         hxswap!(el, "outerHTML"; transition = true)
        1         hxconfirm!(el, "Submit?")
        1         hxindicator!(el, "#loading")
        1         hxvals!(el, "{\"extra\": \"data\"}")
        1         hxheaders!(el, "{\"X-Custom\": \"val\"}")
        1         hxsync!(el, "closest form:abort")
        1         hxdisabledelt!(el, "this")
        1         hxon!(el, "htmx:before-request", "showLoader()")
        1         hxon!(el, "htmx:after-request", "hideLoader()")
        - 
        1         @test getattr(el, "data-hx-post") == "/submit"
        1         @test getattr(el, "data-hx-trigger") == "click once"
        1         @test getattr(el, "data-hx-target") == "#result"
        1         @test occursin("outerHTML", getattr(el, "data-hx-swap"))
        1         @test occursin("transition:true", getattr(el, "data-hx-swap"))
        1         @test getattr(el, "data-hx-confirm") == "Submit?"
        1         @test getattr(el, "data-hx-indicator") == "#loading"
        1         @test getattr(el, "data-hx-vals") == "{\"extra\": \"data\"}"
        1         @test getattr(el, "data-hx-headers") == "{\"X-Custom\": \"val\"}"
        1         @test getattr(el, "data-hx-sync") == "closest form:abort"
        1         @test getattr(el, "data-hx-disabled-elt") == "this"
        1         @test getattr(el, "data-hx-on:htmx:before-request") == "showLoader()"
        1         @test getattr(el, "data-hx-on:htmx:after-request") == "hideLoader()"
        -     end
        - 
        -     @testset "mixing htmx and regular HTML attributes" begin
        2         el = HTMLElement(:button)
        1         el["id"] = "my-btn"
        1         el["class"] = "btn btn-primary"
        1         el["type"] = "button"
        1         el["disabled"] = "true"
        1         hxget!(el, "/api/data")
        1         hxtrigger!(el, "click")
        1         hxtarget!(el, "#output")
        - 
        1         @test getattr(el, "id") == "my-btn"
        1         @test getattr(el, "class") == "btn btn-primary"
        1         @test getattr(el, "type") == "button"
        1         @test getattr(el, "disabled") == "true"
        1         @test getattr(el, "data-hx-get") == "/api/data"
        1         @test getattr(el, "data-hx-trigger") == "click"
        1         @test getattr(el, "data-hx-target") == "#output"
        -     end
        - 
        -     @testset "fluent API: chaining returns" begin
        -         # Verify all mutating functions return the element for chaining
        2         el = HTMLElement(:button)
        1         @test hxget!(el, "/a") === el
        1         @test hxpost!(el, "/b") === el
        1         @test hxput!(el, "/c") === el
        1         @test hxpatch!(el, "/d") === el
        1         @test hxdelete!(el, "/e") === el
        1         @test hxattr!(el, "custom", "val") === el
        1         @test hxrequest!(el, :get, "/f") === el
        1         @test hxtrigger!(el, "click") === el
        1         @test hxtarget!(el, "#t") === el
        1         @test hxswap!(el, "innerHTML") === el
        1         @test hxswapoob!(el) === el
        1         @test hxselect!(el, "#s") === el
        1         @test hxselectoob!(el, "#so") === el
        1         @test hxvals!(el, "{}") === el
        1         @test hxpushurl!(el) === el
        1         @test hxreplaceurl!(el) === el
        1         @test hxconfirm!(el, "?") === el
        1         @test hxprompt!(el, "?") === el
        1         @test hxindicator!(el, "#i") === el
        1         @test hxboost!(el) === el
        1         @test hxinclude!(el, "#inc") === el
        1         @test hxparams!(el, "*") === el
        1         @test hxheaders!(el, "{}") === el
        1         @test hxsync!(el, "this:drop") === el
        1         @test hxencoding!(el) === el
        1         @test hxext!(el, "ext") === el
        1         @test hxon!(el, "click", "fn()") === el
        1         @test hxdisable!(el) === el
        1         @test hxdisabledelt!(el, "this") === el
        1         @test hxdisinherit!(el, "*") === el
        1         @test hxinherit!(el, "*") === el
        1         @test hxhistory!(el) === el
        1         @test hxhistoryelt!(el) === el
        1         @test hxpreserve!(el) === el
        1         @test hxrequestconfig!(el, "timeout:1000") === el
        1         @test hxvalidate!(el) === el
        -     end
        - 
        -     @testset "rendering htmx element to string" begin
        2         el = HTMLElement(:button)
        1         hxget!(el, "/api/data")
        1         hxtrigger!(el, "click")
        1         hxtarget!(el, "#result")
        1         hxswap!(el, "innerHTML")
        - 
        1         html = sprint(print, el)
        1         @test occursin("<button", html)
        1         @test occursin("</button>", html)
        1         @test occursin("data-hx-get=\"/api/data\"", html)
        1         @test occursin("data-hx-trigger=\"click\"", html)
        1         @test occursin("data-hx-target=\"#result\"", html)
        1         @test occursin("data-hx-swap=\"innerHTML\"", html)
        -     end
        - 
        -     @testset "rendering htmx element with entity encoding" begin
        2         el = HTMLElement(:div)
        1         hxconfirm!(el, "Are you sure? It's a \"big\" deal & final.")
        1         html = sprint(print, el)
        -         # Attributes should have entities encoded
        1         @test occursin("data-hx-confirm=", html)
        1         @test occursin("&amp;", html)
        1         @test occursin("&quot;", html)
        1         @test occursin("&#39;", html)
        -     end
        - 
        -     @testset "rendering htmx element prettyprint" begin
        2         el = HTMLElement(:div)
        1         hxget!(el, "/api")
        1         hxtarget!(el, "#out")
        1         child = HTMLElement(:span)
        1         push!(el, child)
        - 
        1         buf = IOBuffer()
        1         prettyprint(buf, el)
        1         html = String(take!(buf))
        1         @test occursin("data-hx-get=\"/api\"", html)
        1         @test occursin("data-hx-target=\"#out\"", html)
        1         @test occursin("<span>", html)
        -     end
        - 
        -     @testset "htmx on void/self-closing elements" begin
        -         # input is a void element
        2         el = HTMLElement(:input)
        1         hxget!(el, "/search")
        1         hxtrigger!(el, "keyup"; delay = "300ms")
        1         html = sprint(print, el)
        1         @test occursin("<input", html)
        1         @test occursin("/>", html)
        1         @test occursin("data-hx-get=\"/search\"", html)
        1         @test !occursin("</input>", html)
        - 
        -         # img element
        1         el2 = HTMLElement(:img)
        1         hxget!(el2, "/lazy-image")
        1         load_trigger(el2)
        1         html2 = sprint(print, el2)
        1         @test occursin("<img", html2)
        1         @test occursin("/>", html2)
        -     end
        - 
        -     @testset "htmx with text content child" begin
        2         el = HTMLElement(:button)
        1         push!(el, HTMLText("Click me"))
        1         hxpost!(el, "/action")
        1         hxtrigger!(el, "click")
        - 
        1         html = sprint(print, el)
        1         @test occursin("Click me", html)
        1         @test occursin("data-hx-post=\"/action\"", html)
        1         @test occursin("data-hx-trigger=\"click\"", html)
        -     end
        - 
        -     @testset "full htmx example: infinite scroll" begin
        2         el = HTMLElement(:div)
        1         hxget!(el, "/api/items?page=2")
        1         hxtrigger!(el, "revealed")
        1         hxswap!(el, "afterend")
        1         hxindicator!(el, "#load-more-spinner")
        - 
        1         @test getattr(el, "data-hx-get") == "/api/items?page=2"
        1         @test getattr(el, "data-hx-trigger") == "revealed"
        1         @test getattr(el, "data-hx-swap") == "afterend"
        1         @test getattr(el, "data-hx-indicator") == "#load-more-spinner"
        -     end
        - 
        -     @testset "full htmx example: lazy loading" begin
        2         el = HTMLElement(:div)
        1         hxget!(el, "/lazy-content")
        1         load_trigger(el)
        1         hxswap!(el, "outerHTML")
        - 
        1         @test getattr(el, "data-hx-get") == "/lazy-content"
        1         @test getattr(el, "data-hx-trigger") == "load"
        1         @test getattr(el, "data-hx-swap") == "outerHTML"
        -     end
        - 
        -     @testset "full htmx example: click to edit" begin
        -         # Display mode
        2         display = HTMLElement(:div)
        1         hxget!(display, "/contact/1/edit")
        1         hxtrigger!(display, "click")
        1         hxswap!(display, "outerHTML")
        - 
        1         @test getattr(display, "data-hx-get") == "/contact/1/edit"
        1         @test getattr(display, "data-hx-trigger") == "click"
        1         @test getattr(display, "data-hx-swap") == "outerHTML"
        -     end
        - 
        -     @testset "full htmx example: inline validation" begin
        2         el = HTMLElement(:input)
        1         el["name"] = "email"
        1         el["type"] = "email"
        1         hxpost!(el, "/validate/email")
        1         hxtrigger!(el, "change"; delay = "200ms")
        1         hxtarget!(el, "next .error-message")
        1         hxswap!(el, "outerHTML")
        - 
        1         @test getattr(el, "name") == "email"
        1         @test getattr(el, "data-hx-post") == "/validate/email"
        1         @test getattr(el, "data-hx-trigger") == "change delay:200ms"
        1         @test getattr(el, "data-hx-target") == "next .error-message"
        -     end
        - 
        -     @testset "full htmx example: SSE and WebSocket-like pattern" begin
        -         # SSE extension
        2         el = HTMLElement(:div)
        1         hxext!(el, "sse")
        1         hxattr!(el, "sse-connect", "/events")
        1         @test getattr(el, "data-hx-ext") == "sse"
        1         @test getattr(el, "data-hx-sse-connect") == "/events"
        - 
        -         # WS extension pattern
        1         el2 = HTMLElement(:div)
        1         hxext!(el2, "ws")
        1         hxattr!(el2, "ws-connect", "/ws")
        1         @test getattr(el2, "data-hx-ext") == "ws"
        1         @test getattr(el2, "data-hx-ws-connect") == "/ws"
        -     end
        - 
        -     @testset "full htmx example: tabs pattern" begin
        2         tab1 = HTMLElement(:button)
        1         hxget!(tab1, "/tab/1")
        1         hxtarget!(tab1, "#tab-content")
        1         hxswap!(tab1, "innerHTML")
        - 
        1         tab2 = HTMLElement(:button)
        1         hxget!(tab2, "/tab/2")
        1         hxtarget!(tab2, "#tab-content")
        1         hxswap!(tab2, "innerHTML")
        - 
        1         @test getattr(tab1, "data-hx-get") == "/tab/1"
        1         @test getattr(tab2, "data-hx-get") == "/tab/2"
        1         @test getattr(tab1, "data-hx-target") == getattr(tab2, "data-hx-target")
        -     end
        - 
        -     @testset "full htmx example: modal dialog" begin
        2         trigger = HTMLElement(:button)
        1         hxget!(trigger, "/modal/confirm")
        1         hxtarget!(trigger, "#modals-here")
        1         hxswap!(trigger, "beforeend")
        - 
        1         @test getattr(trigger, "data-hx-get") == "/modal/confirm"
        1         @test getattr(trigger, "data-hx-target") == "#modals-here"
        1         @test getattr(trigger, "data-hx-swap") == "beforeend"
        -     end
        - 
        -     @testset "full htmx example: progress bar polling" begin
        2         el = HTMLElement(:div)
        1         hxget!(el, "/job/123/progress")
        1         poll_trigger(el, "600ms")
        1         hxtarget!(el, "this")
        1         hxswap!(el, "outerHTML")
        - 
        1         @test getattr(el, "data-hx-get") == "/job/123/progress"
        1         @test getattr(el, "data-hx-trigger") == "every 600ms"
        1         @test getattr(el, "data-hx-target") == "this"
        1         @test getattr(el, "data-hx-swap") == "outerHTML"
        -     end
        - 
        -     @testset "full htmx example: cascading selects" begin
        2         country = HTMLElement(:select)
        1         country["name"] = "country"
        1         hxget!(country, "/api/states")
        1         hxtrigger!(country, "change")
        1         hxtarget!(country, "#state-select")
        1         hxswap!(country, "outerHTML")
        1         hxinclude!(country, "this")
        - 
        1         @test getattr(country, "data-hx-get") == "/api/states"
        1         @test getattr(country, "data-hx-trigger") == "change"
        1         @test getattr(country, "data-hx-target") == "#state-select"
        1         @test getattr(country, "data-hx-include") == "this"
        -     end
        - 
        -     @testset "full htmx example: form with all features" begin
        2         form = HTMLElement(:form)
        1         hxpost!(form, "/api/contacts")
        1         hxtrigger!(form, "submit")
        1         hxtarget!(form, "#contact-list")
        1         hxswap!(form, "beforeend"; settle = "500ms")
        1         hxindicator!(form, "#form-spinner")
        1         hxvalidate!(form)
        1         hxconfirm!(form, "Add this contact?")
        1         hxencoding!(form, "multipart/form-data")
        1         hxheaders!(form, "{\"X-CSRF\": \"token\"}")
        1         hxdisabledelt!(form, "find button")
        - 
        1         @test getattr(form, "data-hx-post") == "/api/contacts"
        1         @test getattr(form, "data-hx-trigger") == "submit"
        1         @test getattr(form, "data-hx-target") == "#contact-list"
        1         swap_val = getattr(form, "data-hx-swap")
        1         @test occursin("beforeend", swap_val)
        1         @test occursin("settle:500ms", swap_val)
        1         @test getattr(form, "data-hx-indicator") == "#form-spinner"
        1         @test getattr(form, "data-hx-validate") == "true"
        1         @test getattr(form, "data-hx-confirm") == "Add this contact?"
        1         @test getattr(form, "data-hx-encoding") == "multipart/form-data"
        1         @test getattr(form, "data-hx-headers") == "{\"X-CSRF\": \"token\"}"
        1         @test getattr(form, "data-hx-disabled-elt") == "find button"
        -     end
        - 
        -     @testset "full htmx example: inheritance control" begin
        2         parent = HTMLElement(:div)
        1         hxboost!(parent)
        1         hxtarget!(parent, "#content")
        - 
        -         # Child disables inheritance
        1         child = HTMLElement(:div)
        1         hxdisinherit!(child, "hx-target")
        1         push!(parent, child)
        - 
        1         @test getattr(parent, "data-hx-boost") == "true"
        1         @test getattr(parent, "data-hx-target") == "#content"
        1         @test getattr(child, "data-hx-disinherit") == "hx-target"
        -     end
        - 
        -     @testset "full htmx example: history and preserve" begin
        -         # Page container with history settings
        2         body = HTMLElement(:body)
        1         hxhistory!(body, "false")  # sensitive page, no caching
        - 
        -         # Video that should persist across swaps
        1         video = HTMLElement(:video)
        1         video["id"] = "bg-video"
        1         hxpreserve!(video)
        - 
        -         # Navigate link
        1         link = HTMLElement(:a)
        1         hxget!(link, "/page/2")
        1         hxpushurl!(link, "/page/2")
        1         hxtarget!(link, "#main")
        1         hxswap!(link, "innerHTML"; transition = true)
        - 
        1         @test getattr(body, "data-hx-history") == "false"
        2         @test hasattr(video, "data-hx-preserve")
        1         @test getattr(link, "data-hx-get") == "/page/2"
        1         @test getattr(link, "data-hx-push-url") == "/page/2"
        -     end
        - 
        -     @testset "full htmx example: disabled content area" begin
        -         # User-generated content area where htmx should be disabled
        2         ugc = HTMLElement(:div)
        1         ugc["class"] = "user-content"
        1         hxdisable!(ugc)
        - 
        2         @test hasattr(ugc, "data-hx-disable")
        1         @test getattr(ugc, "class") == "user-content"
        -     end
        - 
        -     @testset "full htmx example: request config with indicator" begin
        2         el = HTMLElement(:div)
        1         hxget!(el, "/slow-endpoint")
        1         hxrequestconfig!(el, "timeout:30000")
        1         hxindicator!(el, "#long-loading")
        1         load_trigger(el; delay = "100ms")
        - 
        1         @test getattr(el, "data-hx-get") == "/slow-endpoint"
        1         @test getattr(el, "data-hx-request") == "timeout:30000"
        1         @test getattr(el, "data-hx-indicator") == "#long-loading"
        1         @test getattr(el, "data-hx-trigger") == "load delay:100ms"
        -     end
        - 
        -     @testset "full htmx example: select-oob multi-target update" begin
        2         el = HTMLElement(:button)
        1         hxget!(el, "/notifications")
        1         hxselect!(el, "#notification-list")
        1         hxselectoob!(el, "#notification-count,#notification-badge")
        1         hxtarget!(el, "#main-notifications")
        - 
        1         @test getattr(el, "data-hx-get") == "/notifications"
        1         @test getattr(el, "data-hx-select") == "#notification-list"
        1         @test getattr(el, "data-hx-select-oob") == "#notification-count,#notification-badge"
        1         @test getattr(el, "data-hx-target") == "#main-notifications"
        -     end
        - 
        -     @testset "full htmx example: prompt for user input" begin
        2         el = HTMLElement(:button)
        1         hxdelete!(el, "/items/42")
        1         hxprompt!(el, "Type 'DELETE' to confirm")
        1         hxswap!(el, "delete")
        - 
        1         @test getattr(el, "data-hx-delete") == "/items/42"
        1         @test getattr(el, "data-hx-prompt") == "Type 'DELETE' to confirm"
        1         @test getattr(el, "data-hx-swap") == "delete"
        -     end
        - 
        -     @testset "full htmx example: replace-url navigation" begin
        2         el = HTMLElement(:a)
        1         hxget!(el, "/page/3")
        1         hxreplaceurl!(el, "/page/3")
        1         hxtarget!(el, "#content")
        1         hxswap!(el, "innerHTML"; transition = true)
        - 
        1         @test getattr(el, "data-hx-get") == "/page/3"
        1         @test getattr(el, "data-hx-replace-url") == "/page/3"
        1         @test getattr(el, "data-hx-target") == "#content"
        1         @test occursin("transition:true", getattr(el, "data-hx-swap"))
        -     end
        - 
        -     @testset "rendering: sorted attributes in output" begin
        2         el = HTMLElement(:div)
        1         hxget!(el, "/a")
        1         hxtarget!(el, "#b")
        1         hxswap!(el, "innerHTML")
        1         el["id"] = "z"
        - 
        1         html = sprint(print, el)
        -         # Attributes are sorted alphabetically
        1         pos_get = Base.findfirst("data-hx-get", html)
        1         pos_swap = Base.findfirst("data-hx-swap", html)
        1         pos_target = Base.findfirst("data-hx-target", html)
        1         pos_id = Base.findfirst("id=", html)
        - 
        2         @test !isnothing(pos_get)
        2         @test !isnothing(pos_swap)
        2         @test !isnothing(pos_target)
        2         @test !isnothing(pos_id)
        -         # data-hx-get < data-hx-swap < data-hx-target < id
        1         @test first(pos_get) < first(pos_swap)
        1         @test first(pos_swap) < first(pos_target)
        1         @test first(pos_target) < first(pos_id)
        -     end
        - end
